<!DOCTYPE html>
<html lang="ar" data-theme="light" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إنشاء حساب - كونف تراك نظام إدارة حضور المؤتمرات</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.24/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Cairo', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, hsl(var(--p) / 0.1) 0%, hsl(var(--s) / 0.1) 100%);
        }
        
        .floating-elements {
            background-image: 
                radial-gradient(circle at 20% 20%, hsl(var(--p) / 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, hsl(var(--s) / 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, hsl(var(--a) / 0.05) 0%, transparent 50%);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .float-animation { animation: float 3s ease-in-out infinite; }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px hsl(var(--p) / 0.3); }
            50% { box-shadow: 0 0 30px hsl(var(--p) / 0.5); }
        }
        
        .pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }

        .input-focus:focus {
            box-shadow: 0 0 0 3px hsl(var(--p) / 0.2);
        }

        .step-content {
            transition: all 0.3s ease-in-out;
        }

        .step-content.hidden {
            opacity: 0;
            transform: translateX(-20px);
        }

        .step-content:not(.hidden) {
            opacity: 1;
            transform: translateX(0);
        }

        /* RTL specific adjustments */
        .navbar-start {
            flex: none;
        }
        
        .navbar-end {
            flex: 1;
            justify-content: flex-start;
        }

        /* Flip arrows for RTL */
        .fa-arrow-right:before {
            content: "\f060";
        }

        .fa-arrow-left:before {
            content: "\f061";
        }
    </style>
</head>
<body class="min-h-screen gradient-bg floating-elements">
    <!-- Navigation -->
    <div class="navbar bg-base-100/90 backdrop-blur-sm shadow-sm sticky top-0 z-50">
        <div class="navbar-start">
            <a href="index-ar.html" class="btn btn-ghost text-xl font-bold">
                <i class="fas fa-calendar-check ml-2 text-primary"></i>
                <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">كونف تراك</span>
            </a>
        </div>
        <div class="navbar-end gap-2">
            <!-- Theme Toggle -->
            <label class="swap swap-rotate">
                <input type="checkbox" class="theme-controller" value="dark" />
                <i class="fas fa-sun swap-off fill-current w-6 h-6"></i>
                <i class="fas fa-moon swap-on fill-current w-6 h-6"></i>
            </label>
            <a href="index-ar.html" class="btn btn-ghost btn-sm">
                <i class="fas fa-home ml-2"></i>الرئيسية
            </a>
        </div>
    </div>

    <div class="hero min-h-[calc(100vh-4rem)] py-8">
        <div class="hero-content flex-col lg:flex-row-reverse max-w-7xl w-full gap-12">
            <!-- Info Section -->
            <div class="text-center lg:text-right lg:w-1/2 space-y-8">
                <div class="float-animation">
                    <div class="relative inline-block">
                        <i class="fas fa-user-plus text-8xl text-primary drop-shadow-lg"></i>
                        <div class="absolute -top-2 -left-2 w-6 h-6 bg-success rounded-full animate-pulse"></div>
                    </div>
                </div>
                
                <div class="space-y-6">
                    <h1 class="text-5xl lg:text-6xl font-bold">
                        <span class="text-base-content">انضم إلى</span><br>
                        <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">كونف تراك!</span>
                    </h1>
                    <p class="text-xl text-base-content/80 leading-relaxed max-w-lg">
                        أنشئ حسابك لاكتشاف أدوات إدارة المؤتمرات القوية وتتبع الحضور السلس.
                    </p>
                </div>

                <!-- Enhanced Feature Grid -->
                <div class="grid grid-cols-2 gap-6">
                    <div class="card bg-base-100/80 backdrop-blur-sm border border-primary/20 p-4 hover:shadow-lg transition-all duration-300">
                        <div class="flex items-center gap-3">
                            <div class="avatar">
                                <div class="w-12 rounded-full bg-gradient-to-r from-primary to-primary/80">
                                    <div class="flex items-center justify-center h-full">
                                        <i class="fas fa-qrcode text-white text-lg"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="font-bold text-sm">تكامل QR</div>
                                <div class="text-xs text-base-content/70">مسح فوري</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-base-100/80 backdrop-blur-sm border border-secondary/20 p-4 hover:shadow-lg transition-all duration-300">
                        <div class="flex items-center gap-3">
                            <div class="avatar">
                                <div class="w-12 rounded-full bg-gradient-to-r from-secondary to-secondary/80">
                                    <div class="flex items-center justify-center h-full">
                                        <i class="fas fa-chart-line text-white text-lg"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="font-bold text-sm">تحليلات مباشرة</div>
                                <div class="text-xs text-base-content/70">بيانات فورية</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-base-100/80 backdrop-blur-sm border border-accent/20 p-4 hover:shadow-lg transition-all duration-300">
                        <div class="flex items-center gap-3">
                            <div class="avatar">
                                <div class="w-12 rounded-full bg-gradient-to-r from-accent to-accent/80">
                                    <div class="flex items-center justify-center h-full">
                                        <i class="fas fa-mobile-alt text-white text-lg"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="font-bold text-sm">جاهز للجوال</div>
                                <div class="text-xs text-base-content/70">أي جهاز</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-base-100/80 backdrop-blur-sm border border-info/20 p-4 hover:shadow-lg transition-all duration-300">
                        <div class="flex items-center gap-3">
                            <div class="avatar">
                                <div class="w-12 rounded-full bg-gradient-to-r from-info to-info/80">
                                    <div class="flex items-center justify-center h-full">
                                        <i class="fas fa-cloud text-white text-lg"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="font-bold text-sm">مزامنة سحابية</div>
                                <div class="text-xs text-base-content/70">محدث دائماً</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress Indicator -->
                <div class="bg-base-100/80 backdrop-blur-sm rounded-lg p-4 border border-base-content/10">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium">تقدم الإعداد</span>
                        <span class="text-sm text-base-content/70" id="progressText">الخطوة 1 من 3</span>
                    </div>
                    <div class="w-full bg-base-200 rounded-full h-2">
                        <div class="bg-gradient-to-l from-primary to-secondary h-2 rounded-full transition-all duration-500" style="width: 33%" id="progressBar"></div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Registration Form -->
            <div class="card w-full max-w-lg shadow-2xl bg-base-100/95 backdrop-blur-sm border border-base-content/10 lg:w-1/2">
                <div class="card-body p-8">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold mb-2">إنشاء حساب</h2>
                        <p class="text-base-content/70">انضم إلى آلاف منظمي الفعاليات</p>
                    </div>

                    <!-- Enhanced Step Indicator -->
                    <div class="mb-8">
                        <ul class="steps steps-horizontal w-full">
                            <li class="step step-primary text-xs" data-step="1">
                                <div class="step-content-mini">
                                    <i class="fas fa-user"></i>
                                    <span class="hidden sm:inline mr-1">شخصي</span>
                                </div>
                            </li>
                            <li class="step text-xs" data-step="2">
                                <div class="step-content-mini">
                                    <i class="fas fa-briefcase"></i>
                                    <span class="hidden sm:inline mr-1">مهني</span>
                                </div>
                            </li>
                            <li class="step text-xs" data-step="3">
                                <div class="step-content-mini">
                                    <i class="fas fa-shield-alt"></i>
                                    <span class="hidden sm:inline mr-1">الأمان</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <form class="space-y-6">
                        <!-- Step 1: Personal Information -->
                        <div class="step-content" id="step1">
                            <div class="space-y-4">
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div class="form-control">
                                        <label class="label">
                                            <span class="label-text font-medium">الاسم الأول</span>
                                        </label>
                                        <input type="text" placeholder="أحمد" class="input input-bordered input-focus transition-all duration-200" required />
                                    </div>
                                    <div class="form-control">
                                        <label class="label">
                                            <span class="label-text font-medium">الاسم الأخير</span>
                                        </label>
                                        <input type="text" placeholder="محمد" class="input input-bordered input-focus transition-all duration-200" required />
                                    </div>
                                </div>

                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">البريد الإلكتروني</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-envelope text-base-content/40"></i>
                                        </div>
                                        <input type="email" placeholder="ahmed.mohamed@example.com" class="input input-bordered w-full pr-12 input-focus transition-all duration-200" required dir="ltr" />
                                    </div>
                                </div>

                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">رقم الهاتف</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-phone text-base-content/40"></i>
                                        </div>
                                        <input type="tel" placeholder="+20 (123) 456-7890" class="input input-bordered w-full pr-12 input-focus transition-all duration-200" required dir="ltr" />
                                    </div>
                                </div>

                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">الجنسية</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none z-10">
                                            <i class="fas fa-globe text-base-content/40"></i>
                                        </div>
                                        <select class="select select-bordered w-full pr-12 input-focus transition-all duration-200">
                                            <option disabled selected>اختر جنسيتك</option>
                                            <option>مصر</option>
                                            <option>السعودية</option>
                                            <option>الإمارات</option>
                                            <option>الأردن</option>
                                            <option>لبنان</option>
                                            <option>المغرب</option>
                                            <option>الكويت</option>
                                            <option>قطر</option>
                                            <option>أخرى</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Professional Information -->
                        <div class="step-content hidden" id="step2">
                            <div class="space-y-4">
                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">المهنة</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-user-tie text-base-content/40"></i>
                                        </div>
                                        <input type="text" placeholder="مطور برمجيات" class="input input-bordered w-full pr-12 input-focus transition-all duration-200" required />
                                    </div>
                                </div>

                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">الشركة</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-building text-base-content/40"></i>
                                        </div>
                                        <input type="text" placeholder="شركة التقنية المحدودة" class="input input-bordered w-full pr-12 input-focus transition-all duration-200" required />
                                    </div>
                                </div>

                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">المسمى الوظيفي</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-id-badge text-base-content/40"></i>
                                        </div>
                                        <input type="text" placeholder="مطور أول" class="input input-bordered w-full pr-12 input-focus transition-all duration-200" required />
                                    </div>
                                </div>

                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">السيرة المهنية</span>
                                        <span class="label-text-alt">اختياري</span>
                                    </label>
                                    <textarea class="textarea textarea-bordered h-24 input-focus transition-all duration-200 resize-none" placeholder="أخبرنا عن خلفيتك المهنية..."></textarea>
                                </div>

                                <!-- Enhanced Avatar Upload -->
                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">صورة الملف الشخصي</span>
                                        <span class="label-text-alt">اختياري</span>
                                    </label>
                                    <div class="flex items-center gap-4">
                                        <div class="avatar placeholder">
                                            <div class="bg-gradient-to-r from-primary to-secondary text-primary-content rounded-full w-16 h-16 flex items-center justify-center" id="avatarPreview">
                                                <i class="fas fa-user text-2xl"></i>
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <input type="file" class="file-input file-input-bordered file-input-sm w-full" accept="image/*" />
                                            <div class="text-xs text-base-content/60 mt-1">حد أقصى: 2 ميجابايت. JPG, PNG, GIF</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Security -->
                        <div class="step-content hidden" id="step3">
                            <div class="space-y-4">
                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">كلمة المرور</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-lock text-base-content/40"></i>
                                        </div>
                                        <input type="password" placeholder="أدخل كلمة مرور قوية" class="input input-bordered w-full pr-12 pl-12 input-focus transition-all duration-200" required id="passwordInput" />
                                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center">
                                            <button type="button" class="toggle-password text-base-content/40 hover:text-primary transition-colors">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <!-- Enhanced Password strength indicator -->
                                    <div class="mt-3 space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-xs text-base-content/70">قوة كلمة المرور</span>
                                            <span class="text-xs font-medium" id="strengthText">ضعيفة</span>
                                        </div>
                                        <div class="w-full bg-base-200 rounded-full h-2">
                                            <div class="bg-error h-2 rounded-full transition-all duration-300" style="width: 0%" id="strengthBar"></div>
                                        </div>
                                        <div class="text-xs text-base-content/50" id="passwordRequirements">
                                            <div class="grid grid-cols-2 gap-1">
                                                <span id="req-length" class="flex items-center gap-1">
                                                    <i class="fas fa-times text-error text-xs"></i>8+ أحرف
                                                </span>
                                                <span id="req-upper" class="flex items-center gap-1">
                                                    <i class="fas fa-times text-error text-xs"></i>حرف كبير
                                                </span>
                                                <span id="req-lower" class="flex items-center gap-1">
                                                    <i class="fas fa-times text-error text-xs"></i>حرف صغير
                                                </span>
                                                <span id="req-number" class="flex items-center gap-1">
                                                    <i class="fas fa-times text-error text-xs"></i>رقم
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">تأكيد كلمة المرور</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-lock text-base-content/40"></i>
                                        </div>
                                        <input type="password" placeholder="أكد كلمة المرور" class="input input-bordered w-full pr-12 input-focus transition-all duration-200" required id="confirmPasswordInput" />
                                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center" id="passwordMatchIcon" style="display: none;">
                                            <i class="fas fa-check text-success"></i>
                                        </div>
                                    </div>
                                    <div class="text-xs mt-1" id="passwordMatchText"></div>
                                </div>

                                <!-- Enhanced NFC Card ID -->
                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-medium">معرف بطاقة NFC</span>
                                        <span class="label-text-alt">اختياري - يتم إنشاؤه تلقائياً إذا تُرك فارغاً</span>
                                    </label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                                            <i class="fas fa-credit-card text-base-content/40"></i>
                                        </div>
                                        <input type="text" placeholder="اتركه فارغاً للإنشاء التلقائي" class="input input-bordered w-full pr-12 pl-24 input-focus transition-all duration-200" id="nfcCardInput" />
                                        <div class="absolute inset-y-0 left-0 pl-2 flex items-center">
                                            <button type="button" class="btn btn-ghost btn-sm" onclick="generateCardId()">
                                                <i class="fas fa-random ml-1"></i>إنشاء
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Enhanced Terms and Conditions -->
                                <div class="space-y-3">
                                    <div class="form-control">
                                        <label class="cursor-pointer flex items-start gap-3 p-3 rounded-lg border border-base-content/20 hover:bg-base-200/50 transition-colors">
                                            <input type="checkbox" class="checkbox checkbox-primary checkbox-sm mt-0.5" required />
                                            <div class="text-sm leading-relaxed">
                                                أوافق على 
                                                <a href="#" class="link link-primary font-medium">شروط الخدمة</a> 
                                                و 
                                                <a href="#" class="link link-primary font-medium">سياسة الخصوصية</a>
                                                <div class="text-xs text-base-content/60 mt-1">مطلوب لإنشاء حساب</div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="form-control">
                                        <label class="cursor-pointer flex items-start gap-3 p-3 rounded-lg border border-base-content/10 hover:bg-base-200/30 transition-colors">
                                            <input type="checkbox" class="checkbox checkbox-primary checkbox-sm mt-0.5" />
                                            <div class="text-sm leading-relaxed">
                                                أرسل لي تحديثات حول الميزات الجديدة والمؤتمرات وإعلانات المنتج
                                                <div class="text-xs text-base-content/60 mt-1">يمكنك إلغاء الاشتراك في أي وقت</div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Enhanced Navigation Buttons -->
                        <div class="flex justify-between items-center pt-6 border-t border-base-content/10">
                            <button type="button" class="btn btn-outline" id="prevBtn" onclick="changeStep(-1)" style="display: none;">
                                <i class="fas fa-arrow-left ml-2"></i>السابق
                            </button>
                            <div class="flex-1 text-center" id="stepInfo">
                                <span class="text-sm text-base-content/60">الخطوة 1 من 3</span>
                            </div>
                            <button type="button" class="btn btn-primary shadow-lg" id="nextBtn" onclick="changeStep(1)">
                                التالي<i class="fas fa-arrow-right mr-2"></i>
                            </button>
                            <button type="button" class="btn btn-success shadow-lg pulse-glow" id="submitBtn" onclick="handleRegister()" style="display: none;">
                                <i class="fas fa-user-plus ml-2"></i>إنشاء حساب
                            </button>
                        </div>

                        <!-- Enhanced Login Link -->
                        <div class="text-center pt-4 border-t border-base-content/10">
                            <p class="text-base-content/70">
                                لديك حساب بالفعل؟ 
                                <a href="auth-login-ar.html" class="link link-primary font-semibold hover:link-hover">
                                    سجل دخولك هنا
                                </a>
                            </p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Toast -->
    <div class="toast toast-top toast-start z-50" id="toast" style="display: none;">
        <div class="alert shadow-lg border border-base-content/20">
            <i class="fas fa-check-circle"></i>
            <div>
                <h3 class="font-bold">نجح!</h3>
                <div class="text-xs">تم التسجيل بنجاح! تحقق من بريدك الإلكتروني.</div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 3;

        // Theme toggle functionality
        const themeController = document.querySelector('.theme-controller');
        const html = document.documentElement;
        
        const savedTheme = localStorage.getItem('theme') || 'light';
        html.setAttribute('data-theme', savedTheme);
        if (savedTheme === 'dark') {
            themeController.checked = true;
        }
        
        themeController.addEventListener('change', function() {
            const theme = this.checked ? 'dark' : 'light';
            html.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
        });

        // Enhanced step navigation with validation
        function changeStep(direction) {
            const newStep = currentStep + direction;
            
            if (newStep < 1 || newStep > totalSteps) return;
            
            // Validate current step before proceeding
            if (direction > 0 && !validateCurrentStep()) {
                return;
            }
            
            // Smooth transition
            const currentStepElement = document.getElementById(`step${currentStep}`);
            const newStepElement = document.getElementById(`step${newStep}`);
            
            currentStepElement.classList.add('hidden');
            setTimeout(() => {
                newStepElement.classList.remove('hidden');
            }, 150);
            
            // Update step indicator
            document.querySelectorAll('.step').forEach((step, index) => {
                if (index + 1 <= newStep) {
                    step.classList.add('step-primary');
                } else {
                    step.classList.remove('step-primary');
                }
            });
            
            currentStep = newStep;
            updateInterface();
        }

        function validateCurrentStep() {
            const currentStepElement = document.getElementById(`step${currentStep}`);
            const requiredFields = currentStepElement.querySelectorAll('input[required], select[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('input-error');
                    isValid = false;
                } else {
                    field.classList.remove('input-error');
                }
            });
            
            if (!isValid) {
                showToast('يرجى ملء جميع الحقول المطلوبة', 'error', 'خطأ في التحقق');
            }
            
            return isValid;
        }

        function updateInterface() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');
            const stepInfo = document.getElementById('stepInfo');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            // Update step info
            stepInfo.innerHTML = `<span class="text-sm text-base-content/60">الخطوة ${currentStep} من ${totalSteps}</span>`;
            
            // Update progress bar
            const progress = (currentStep / totalSteps) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `الخطوة ${currentStep} من ${totalSteps}`;
            
            // Update buttons
            if (currentStep === 1) {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            } else if (currentStep === totalSteps) {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
        }

        // Enhanced password toggle
        document.querySelector('.toggle-password').addEventListener('click', function() {
            const passwordInput = this.closest('.relative').querySelector('input');
            const icon = this.querySelector('i');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                passwordInput.type = 'password';
                icon.className = 'fas fa-eye';
            }
        });

        // Enhanced password strength checker
        document.getElementById('passwordInput').addEventListener('input', function() {
            const password = this.value;
            const strengthBar = document.getElementById('strengthBar');
            const strengthText = document.getElementById('strengthText');
            
            let strength = 0;
            const requirements = {
                length: password.length >= 8,
                upper: /[A-Z]/.test(password),
                lower: /[a-z]/.test(password),
                number: /[0-9]/.test(password)
            };
            
            // Update requirement indicators
            Object.keys(requirements).forEach(req => {
                const element = document.getElementById(`req-${req}`);
                const icon = element.querySelector('i');
                if (requirements[req]) {
                    icon.className = 'fas fa-check text-success text-xs';
                    strength += 25;
                } else {
                    icon.className = 'fas fa-times text-error text-xs';
                }
            });
            
            // Update strength bar and text
            strengthBar.style.width = `${strength}%`;
            
            if (strength < 50) {
                strengthBar.className = 'bg-error h-2 rounded-full transition-all duration-300';
                strengthText.textContent = 'ضعيفة';
                strengthText.className = 'text-xs font-medium text-error';
            } else if (strength < 75) {
                strengthBar.className = 'bg-warning h-2 rounded-full transition-all duration-300';
                strengthText.textContent = 'مقبولة';
                strengthText.className = 'text-xs font-medium text-warning';
            } else if (strength < 100) {
                strengthBar.className = 'bg-info h-2 rounded-full transition-all duration-300';
                strengthText.textContent = 'جيدة';
                strengthText.className = 'text-xs font-medium text-info';
            } else {
                strengthBar.className = 'bg-success h-2 rounded-full transition-all duration-300';
                strengthText.textContent = 'ممتازة';
                strengthText.className = 'text-xs font-medium text-success';
            }
        });

        // Password confirmation checker
        function checkPasswordMatch() {
            const password = document.getElementById('passwordInput').value;
            const confirmPassword = document.getElementById('confirmPasswordInput').value;
            const matchIcon = document.getElementById('passwordMatchIcon');
            const matchText = document.getElementById('passwordMatchText');
            
            if (confirmPassword.length > 0) {
                if (password === confirmPassword) {
                    matchIcon.style.display = 'flex';
                    matchIcon.innerHTML = '<i class="fas fa-check text-success"></i>';
                    matchText.textContent = 'كلمات المرور متطابقة';
                    matchText.className = 'text-xs mt-1 text-success';
                } else {
                    matchIcon.style.display = 'flex';
                    matchIcon.innerHTML = '<i class="fas fa-times text-error"></i>';
                    matchText.textContent = 'كلمات المرور غير متطابقة';
                    matchText.className = 'text-xs mt-1 text-error';
                }
            } else {
                matchIcon.style.display = 'none';
                matchText.textContent = '';
            }
        }

        document.getElementById('confirmPasswordInput').addEventListener('input', checkPasswordMatch);
        document.getElementById('passwordInput').addEventListener('input', checkPasswordMatch);

        // Generate enhanced card ID
        function generateCardId() {
            const cardIdInput = document.getElementById('nfcCardInput');
            const timestamp = Date.now().toString().slice(-6);
            const randomStr = Math.random().toString(36).substr(2, 6).toUpperCase();
            const randomId = `NFC-${timestamp}-${randomStr}`;
            
            cardIdInput.value = randomId;
            
            // Visual feedback
            cardIdInput.focus();
            setTimeout(() => cardIdInput.blur(), 100);
        }

        // Enhanced registration handling
        function handleRegister() {
            // Final validation
            if (!validateCurrentStep()) return;
            
            const termsCheckbox = document.querySelector('input[type="checkbox"][required]');
            if (!termsCheckbox.checked) {
                showToast('يرجى الموافقة على الشروط والأحكام', 'error', 'الشروط مطلوبة');
                return;
            }
            
            const password = document.getElementById('passwordInput').value;
            const confirmPassword = document.getElementById('confirmPasswordInput').value;
            
            if (password !== confirmPassword) {
                showToast('كلمات المرور غير متطابقة', 'error', 'عدم تطابق كلمة المرور');
                return;
            }
            
            const button = document.getElementById('submitBtn');
            const originalContent = button.innerHTML;
            button.innerHTML = '<span class="loading loading-spinner loading-sm"></span> جاري إنشاء الحساب...';
            button.disabled = true;
            button.classList.remove('pulse-glow');

            // Simulate registration process
            setTimeout(() => {
                showToast('تم إنشاء الحساب بنجاح! يرجى التحقق من بريدك الإلكتروني للتأكيد.', 'success', 'مرحباً بك في كونف تراك!');
                
                setTimeout(() => {
                    window.location.href = 'user-profile-ar.html';
                }, 3000);
            }, 3000);
        }

        function showToast(message, type = 'success', title = 'إشعار') {
            const toast = document.getElementById('toast');
            const alert = toast.querySelector('.alert');
            const titleElement = alert.querySelector('h3');
            const messageElement = alert.querySelector('.text-xs');
            
            alert.className = `alert alert-${type} shadow-lg border border-base-content/20`;
            titleElement.textContent = title;
            messageElement.textContent = message;
            
            const icon = alert.querySelector('i');
            switch(type) {
                case 'success':
                    icon.className = 'fas fa-check-circle';
                    break;
                case 'error':
                    icon.className = 'fas fa-exclamation-circle';
                    break;
                case 'warning':
                    icon.className = 'fas fa-exclamation-triangle';
                    break;
                case 'info':
                    icon.className = 'fas fa-info-circle';
                    break;
            }
            
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 6000);
        }

        // File upload preview with enhanced functionality
        document.querySelector('input[type="file"]').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const preview = document.getElementById('avatarPreview');
            
            if (file) {
                // Validate file size (2MB limit)
                if (file.size > 2 * 1024 * 1024) {
                    showToast('حجم الملف كبير جداً. يرجى اختيار ملف أقل من 2 ميجابايت.', 'error', 'الملف كبير جداً');
                    this.value = '';
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Avatar" class="rounded-full w-16 h-16 object-cover">`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '<i class="fas fa-user text-2xl"></i>';
            }
        });

        // Input field enhancements
        document.querySelectorAll('.input, .textarea, .select').forEach(input => {
            input.addEventListener('focus', function() {
                const icon = this.parentElement.querySelector('i');
                if (icon) icon.classList.add('text-primary');
            });
            
            input.addEventListener('blur', function() {
                const icon = this.parentElement.querySelector('i');
                if (icon) icon.classList.remove('text-primary');
            });
        });

        // Initialize
        updateInterface();
    </script>
</body>
</html>